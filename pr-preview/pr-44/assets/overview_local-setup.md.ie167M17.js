import{_ as t,c as a,o as s,a4 as o}from"./chunks/framework.tUhz7RHD.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"overview/local-setup.md","filePath":"overview/local-setup.md"}'),l={name:"overview/local-setup.md"};function i(r,e,n,p,c,d){return s(),a("div",null,[...e[0]||(e[0]=[o(`<h2 id="local-setup" tabindex="-1">Local Setup <a class="header-anchor" href="#local-setup" aria-label="Permalink to &quot;Local Setup&quot;">​</a></h2><p>The local setup can be used to create a complete PlatformMesh local environment for testing or demo purposes. The local-setup scripts and configuration are located in the <a href="https://github.com/platform-mesh/helm-charts" target="_blank" rel="noreferrer">github.com/platform-mesh/helm-charts</a> repository, <code>local-setup</code> directory. For further documentation refer to the READMEs in the <code>local-setup</code> directoring of the <code>helm-charts</code> repository.</p><h3 id="supported-platforms" tabindex="-1">Supported platforms <a class="header-anchor" href="#supported-platforms" aria-label="Permalink to &quot;Supported platforms&quot;">​</a></h3><ul><li>linux/amd64</li><li>darwin/arm64</li></ul><h3 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h3><ul><li>Docker and Kind</li><li>Helm</li><li>Kubectl</li><li>Taskfile <a href="https://taskfile.dev/" target="_blank" rel="noreferrer">https://taskfile.dev/</a></li><li>mkcert</li></ul><p>Additional tooling might be downloaded automatically during setup.</p><p>Minimum Docker resources:</p><ul><li>12 Gb of RAM</li><li>10 CPUs</li></ul><h3 id="quick-start" tabindex="-1">Quick Start <a class="header-anchor" href="#quick-start" aria-label="Permalink to &quot;Quick Start&quot;">​</a></h3><p>Before running the setup scripts, some local configuration is needed. Add the following entries to your local <code>/etc/hosts</code> file</p><div class="language-file vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">file</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>127.0.0.1       kcp.api.portal.dev.local portal.dev.local</span></span>
<span class="line"><span>127.0.0.1       *.portal.dev.local default.portal.dev.local</span></span></code></pre></div><p>Run the following commands at the root level of the repository.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Full setup (deletes existing cluster and creates new one)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local-setup</span></span></code></pre></div><p>After the script is finished, it should print <code>Installation Complete ♥ !</code> along with some instructions on navigating to the portal.</p><p>You can also iterate on an existing cluster (faster, preserves cluster state):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Iterate on existing cluster (faster, preserves cluster)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local-setup:iterate</span></span></code></pre></div><h3 id="testing-local-setup" tabindex="-1">Testing local setup <a class="header-anchor" href="#testing-local-setup" aria-label="Permalink to &quot;Testing local setup&quot;">​</a></h3><p>Use the following task:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># run only once</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test:portal-e2e</span></span></code></pre></div><h3 id="description-of-the-bootstrap-procedure" tabindex="-1">Description of the bootstrap procedure <a class="header-anchor" href="#description-of-the-bootstrap-procedure" aria-label="Permalink to &quot;Description of the bootstrap procedure&quot;">​</a></h3><p>When the <code>local-setup</code> task is run, the following steps are performed:</p><ul><li>downloads required tooling in the <code>bin</code> directory</li><li>runs the <code>start.sh</code> script</li></ul><p>The rest of the steps are performed in the start.sh scirpt:</p><ul><li>performs checks - platform compatability and environment</li><li>deletes and creates a fresh KIND cluster named <code>platform-mesh</code></li><li>creates certificates for hosts &quot;<em>.dev.local&quot; &quot;</em>.portal.dev.local&quot; in the <code>certs</code> directory</li><li>installs FluxCD via Helm in the cluster</li><li>applies base kustomizations: CRDs, KRO, namespaces, OCM, ResourceGraphDefinition</li><li>creates neceserry secrets in the cluster</li><li>applies default kustomize overlay: <code>platform-mesh-operator</code> and <code>ocm-component</code></li><li>instanciates the <code>platform-mesh-operator</code></li><li>applies the <code>PlatformMesh</code> custom resource to the cluster</li><li>waits until installed resources become ready</li><li>creates a local KCP Kubeconfig</li><li>prints <code>Installation Complete</code> message</li></ul><p>The main part of the bootstrap procedure is actually delegated to the <code>platform-mesh-operator</code>. It creates all required PlatformMesh components and configures them by reconciling the <code>PlatformMesh</code> custom kubernetes resource, located on this path: <code>local-setup/kustomize/components/platform-mesh-operator-resource/platform-mesh.yaml</code>. For more detailed documentation about the API provided by this resource, see <a href="https://github.com/platform-mesh/platform-mesh-operator" target="_blank" rel="noreferrer">github.com/platform-mesh/platform-mesh-operator</a>.</p>`,26)])])}const m=t(l,[["render",i]]);export{u as __pageData,m as default};
